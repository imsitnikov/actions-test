"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.useCollapseActions = void 0;
const react_1 = __importDefault(require("react"));
const useDropdownActions_1 = require("./useDropdownActions");
const useObserveIntersection_1 = require("./useObserveIntersection");
const MAX_BUTTON_ACTIONS = 4;
const useCollapseActions = (actions) => {
    const updateObserveKey = react_1.default.useMemo(() => actions.map(({ id }) => id).join('/'), [actions]);
    const [buttonActions, restActions] = react_1.default.useMemo(() => {
        const buttonItems = [];
        const restItems = [];
        actions.forEach((action) => {
            if (buttonItems.length < MAX_BUTTON_ACTIONS && !action.collapsed) {
                buttonItems.push(action);
            }
            else {
                restItems.push(action);
            }
        });
        return [buttonItems, restItems];
    }, [actions]);
    const { parentRef, visibilityMap, offset } = (0, useObserveIntersection_1.useObserveIntersection)(updateObserveKey);
    const dropdownItems = (0, useDropdownActions_1.useDropdownActions)({ buttonActions, restActions, visibilityMap });
    return {
        buttonActions,
        dropdownItems,
        parentRef,
        offset,
        visibilityMap,
    };
};
exports.useCollapseActions = useCollapseActions;
