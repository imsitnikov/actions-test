import { dateTime, dateTimeParse } from '@gravity-ui/date-utils';
import { getPresetTitle } from './components/Presets/utils';
export function resolveTimeZone(timeZone) {
    if (timeZone === 'default' || timeZone === 'system') {
        return dateTime({ timeZone }).timeZone();
    }
    return timeZone;
}
export function normalizeTimeZone(timeZone) {
    const lowered = timeZone.toLowerCase();
    if (lowered === 'default' || lowered === 'system') {
        return lowered;
    }
    return resolveTimeZone(timeZone);
}
export function getTimeZoneOffset(timeZone) {
    return `UTC ${dateTime({ timeZone }).format('Z')}`;
}
export function getDefaultTitle({ value, timeZone, alwaysShowAsAbsolute, format = 'L', presets, }) {
    var _a, _b, _c, _d, _e, _f;
    if (!value) {
        return '';
    }
    const tz = timeZone === 'system' ? '' : ` (${getTimeZoneOffset(timeZone)})`;
    let from = '';
    if (value.start) {
        from =
            value.start.type === 'relative' && !alwaysShowAsAbsolute
                ? value.start.value
                : (_b = (_a = dateTimeParse(value.start.value, { timeZone })) === null || _a === void 0 ? void 0 : _a.format(format)) !== null && _b !== void 0 ? _b : '';
    }
    let to = '';
    if (value.end) {
        to =
            value.end.type === 'relative' && !alwaysShowAsAbsolute
                ? value.end.value
                : (_d = (_c = dateTimeParse(value.end.value, { timeZone, roundUp: true })) === null || _c === void 0 ? void 0 : _c.format(format)) !== null && _d !== void 0 ? _d : '';
    }
    if (!alwaysShowAsAbsolute &&
        ((_e = value.start) === null || _e === void 0 ? void 0 : _e.type) === 'relative' &&
        ((_f = value.end) === null || _f === void 0 ? void 0 : _f.type) === 'relative') {
        return `${getPresetTitle(value.start.value, value.end.value, presets)}${tz}`;
    }
    const delimiter = ' â€” ';
    return `${from}${delimiter}${to}${tz}`;
}
